# FGLS EXP NO ALFABET
modx <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, df)
mod4 <- lm(log(resid(modx)^2) ~  densita + urbana  + pil + dummy_ort + dummy_prot, df)
sd_error <- sqrt(exp(fitted(mod2)))
mod5 <- lm(I(vitamas/sd_error) ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), df)
summary(mod5)
anova(mod5)
white.test(mod5, df)
# FGLS EXP NO ALFABET
modx <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, df)
mod4 <- lm(log(resid(modx)^2) ~  densita + urbana  + pil + dummy_ort + dummy_prot, df)
sd_error <- sqrt(exp(fitted(mod4)))
mod5 <- lm(I(vitamas/sd_error) ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), df)
summary(mod5)
anova(mod5)
white.test(mod5, df)
par(mfrow=c(1,1))
plot(mod5, which = 1, pch = 19)
dwtest(mod5)
ols_coll_diag(mod5)
shapiro.test(resid(mod5))
ks.test(resid(mod5),"pnorm")
plot(mod5,which=3,pch=19)
plot(mod5,which=2,pch=19)
install.packages("mctest")
hist(resid(mod5),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod5)),col=2,lwd=2)
df$log_vitamas = log(df$vitamas/sd_error)
shapiro.test(df$log_vitamas)
df$quadrato_vitamas = (df$vitamas/sd_error)Ë†2
df$quadrato_vitamas = (df$vitamas/sd_error)^2
shapiro.test(df$quadrato_vitamas)
df$radice_vitamas = sqrt(df$vitamas/sd_error))
df$radice_vitamas = sqrt(df$vitamas/sd_error)
shapiro.test(df$radice_vitamas)
hist(df$radice_vitamas, pch=19, cex=.5, col='lightgreen', freq = F)
hist(df$radice_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$radice_vitamas, col = 2, lwd = 2))
hist(df$radice_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$radice_vitamas, col=2, lwd=2))
lines(density(df$radice_vitamas),col=2, lwd=2)
hist(df$radice_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$radice_vitamas),col=2, lwd=2)
df$radice_vitamas = I(sqrt(df$vitamas/sd_error))
df$radice_vitamas = I(sqrt(df$vitamas/sd_error))
shapiro.test(df$radice_vitamas)
hist(df$radice_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$radice_vitamas),col=2, lwd=2)
mod5_new <- lm(df$radice_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), df)
summary(mod5_new)
anova(mod5_new)
white.test(mod5_new, df)
par(mfrow=c(1,1))
plot(mod5, which = 1, pch = 19)
dwtest(mod5_new)
ols_coll_diag(mod5_new)
shapiro.test(resid(mod5_5))
shapiro.test(resid(mod5_new))
View(df)
mod5_new <- lm(df$log_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), df)
summary(mod5_new)
anova(mod5_new)
white.test(mod5_new, df)
par(mfrow=c(1,1))
plot(mod5, which = 1, pch = 19)
dwtest(mod5_new)
ols_coll_diag(mod5_new)
shapiro.test(resid(mod5_new))
ks.test(resid(mod5),"pnorm")
hist(resid(mod5),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod5)),col=2,lwd=2)
ks.test(resid(mod5_new),"pnorm")
plot(mod5_new,which=2,pch=19)
hist(resid(mod5_new),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod5_new)),col=2,lwd=2)
mod5_new <- lm(df$quadrato_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), df)
summary(mod5_new)
anova(mod5_new)
white.test(mod5_new, df)
par(mfrow=c(1,1))
plot(mod5, which = 1, pch = 19)
dwtest(mod5_new)
ols_coll_diag(mod5_new)
shapiro.test(resid(mod5_new))
ks.test(resid(mod5_new),"pnorm")
plot(mod5_new,which=2,pch=19)
hist(resid(mod5_new),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod5_new)),col=2,lwd=2)
# SISTEMO NORMALITA
df$inverso_vitamas = I(1/(df$vitamas/sd_error))
mod5_new <- lm(df$inverso_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), df)
summary(mod5_new)
anova(mod5_new)
summary(mod5_new)
anova(mod5_new)
white.test(mod5_new, df)
par(mfrow=c(1,1))
plot(mod5, which = 1, pch = 19)
dwtest(mod5_new)
ols_coll_diag(mod5_new)
shapiro.test(resid(mod5_new))
ks.test(resid(mod5_new),"pnorm")
plot(mod5_new,which=2,pch=19)
hist(resid(mod5_new),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod5_new)),col=2,lwd=2)
hist(df$inverso_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
hist(df$inverso_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$radice_vitamas),col=2, lwd=2)
lines(density(df$inverso_vitamas),col=2, lwd=2)
df$ESTREME <- 1 #- nuova colonna nel dataframe
#Uso la funzione FIND_EXTREME_OBSERVATION per determinare gli outlier e li setto a 2 nella nuova colonna, applico la funzione ad ogni attributo per cui voglio identificare gli outlier
df$ESTREME[c(FIND_EXTREME_OBSERVATION(densita/sd_error,2))] <- 2
FIND_EXTREME_OBSERVARION <- function(x,sd_factor=2){
which(x>mean(x)+sd_factor*sd(x) | x<mean(x)-sd_factor*sd(x))
}
df$ESTREME[c(FIND_EXTREME_OBSERVATION(densita/sd_error,2))] <- 2
#Uso la funzione FIND_EXTREME_OBSERVATION per determinare gli outlier e li setto a 2 nella nuova colonna, applico la funzione ad ogni attributo per cui voglio identificare gli outlier
df$ESTREME[c(FIND_EXTREME_OBSERVARION(densita/sd_error,2))] <- 2
#Uso la funzione FIND_EXTREME_OBSERVATION per determinare gli outlier e li setto a 2 nella nuova colonna, applico la funzione ad ogni attributo per cui voglio identificare gli outlier
df$ESTREME[c(FIND_EXTREME_OBSERVARION(I(densita/sd_error),2))] <- 2
#Uso la funzione FIND_EXTREME_OBSERVATION per determinare gli outlier e li setto a 2 nella nuova colonna, applico la funzione ad ogni attributo per cui voglio identificare gli outlier
df$ESTREME[c(FIND_EXTREME_OBSERVARION(densita,2))] <- 2
#Uso la funzione FIND_EXTREME_OBSERVATION per determinare gli outlier e li setto a 2 nella nuova colonna, applico la funzione ad ogni attributo per cui voglio identificare gli outlier
df$ESTREME[c(FIND_EXTREME_OBSERVARION(df$densita,2))] <- 2
shapiro.test(df$radice_vitamas)
#plotto i dati evidenziando gli outliers
plot(df$densita, df$radice_vitamas, pch = 19, col = d$ESTREME, xlab="REGR", ylab="VAR_DIP")
#plotto i dati evidenziando gli outliers
plot(df$densita, df$radice_vitamas, pch = 19, col = d$ESTREME, xlab="REGR", ylab="VAR_DIP")
#plotto i dati evidenziando gli outliers
plot(df$densita, df$radice_vitamas, pch = 19, col = df$ESTREME, xlab="REGR", ylab="VAR_DIP")
d_noout <- df[-c(FIND_EXTREME_OBSERVATION(df$densita,2)),]
d_noout <- df[-c(FIND_EXTREME_OBSERVARION(df$densita,2)),]
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod8 <- lm(log(resid(mod7)^2) ~  densita + urbana  + pil + dummy_ort + dummy_prot, d_noout)
sd_error <- sqrt(exp(fitted(mod8)))
mod9 <- lm(I(vitamas/sd_error) ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9)
anova(mod9)
white.test(mod9, df)
white.test(mod9, d_noout)
par(mfrow=c(1,1))
plot(mod9, which = 1, pch = 19)
dwtest(mod9)
ols_coll_diag(mod9)
shapiro.test(resid(mod9))
# PROVO CON RADICE
d_noout$radice_vitamas = I(sqrt(d_noout$vitamas/sd_error))
shapiro.test(d_noout$radice_vitamas)
mod5_new <- lm(d_noout$radice_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
mod8_new <- lm(d_noout$radice_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
mod9_new <- lm(d_noout$radice_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9))
shapiro.test(resid(mod9_new))
# PROVO CON log
d_noout$log_vitamas = I(log(d_noout$vitamas/sd_error))
shapiro.test(d_noout$log_vitamas)
mod9_new <- lm(d_noout$log_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
# PROVO CON QUADRATO
d_noout$quad_vitamas = I((d_noout$vitamas/sd_error)^2)
shapiro.test(d_noout$log_vitamas)
mod9_new <- lm(d_noout$quad_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
white.test(mod9_new, d_noout)
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
ols_coll_diag(mod9)
shapiro.test(resid(mod9_new))
ols_coll_diag(mod9_new)
shapiro.test(resid(mod9_new))
ks.test(resid(mod9_new),"pnorm")
plot(mod9_new,which=1,pch=19)
plot(mod9_new,which=2,pch=19)
# NORMALITA
hist(resid(mod9_new),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod9_new)),col=2,lwd=2)
plot(mod9_new,which=3,pch=19)
plot(mod9_new,which=4,pch=19)
abline(h=2*4/nrow(d_noout),col=2,lwd=3,lty=2)
plot(mod9_new,which=5,pch=19)
d_noout[6,]
d_noout[5,]
summary(df)
summary(df[VAR_NUMERIC])
d_noout <- df[-c(FIND_EXTREME_OBSERVARION(df$densita,2),FIND_EXTREME_OBSERVARION(df$pil,2)),]
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod8 <- lm(log(resid(mod7)^2) ~  densita + urbana  + pil + dummy_ort + dummy_prot, d_noout)
sd_error <- sqrt(exp(fitted(mod8)))
df$radice_vitamas = I(sqrt(df$vitamas/sd_error))
sd_error <- sqrt(exp(fitted(mod8)))
mod9 <- lm(I(vitamas/sd_error) ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9)
anova(mod9)
white.test(mod9, d_noout)
par(mfrow=c(1,1))
plot(mod9, which = 1, pch = 19)
dwtest(mod9)
ols_coll_diag(mod9)
shapiro.test(resid(mod9))
# PROVO CON RADICE
d_noout$radice_vitamas = I(sqrt(d_noout$vitamas/sd_error))
shapiro.test(d_noout$radice_vitamas)
hist(df$inverso_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$inverso_vitamas),col=2, lwd=2)
mod9_new <- lm(d_noout$radice_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
# PROVO CON log
d_noout$log_vitamas = I(log(d_noout$vitamas/sd_error))
shapiro.test(d_noout$log_vitamas)
mod9_new <- lm(d_noout$log_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
# ETERO??
plot(mod9_new,which=1,pch=19)
hist(resid(mod9_new),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod9_new)),col=2,lwd=2)
plot(mod9_new,which=2,pch=19)
plot(mod9_new,which=3,pch=19)
plot(mod9_new,which=4,pch=19)
abline(h=2*4/nrow(d_noout),col=2,lwd=3,lty=2)
d[29]
d_noaut[29]
d_noout[29]
d_noout[29,]
d_noout[27,]
summary(d_noout)
summary(d_noout[VAR_NUMERIC])
summary(df[VAR_NUMERIC])
d_noout[5,]
d_noout[27,]
plot(mod9_new,which=5,pch=19)
d_noout = d_noout[-c(27,5)]
d_noout[5,]
d_noout[27,]
d_noout <-  d_noout[-c(27,5)]
d_noout[5,]
d_noout <-  d_noout[-c(27)]
d_noout[27,]
d_noout <-  d_noout[-c(27, 5)]
d_noout[27,]
d_noout <-  d_noout[-c(27, 5),]
d_noout[5,]
d_noout[27,]
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod8 <- lm(log(resid(mod7)^2) ~  densita + urbana  + pil + dummy_ort + dummy_prot, d_noout)
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
d_noout
# ELIMINO OUTLIER
df$ESTREME <- 1 #- nuova colonna nel dataframe
#Uso la funzione FIND_EXTREME_OBSERVATION per determinare gli outlier e li setto a 2 nella nuova colonna, applico la funzione ad ogni attributo per cui voglio identificare gli outlier
df$ESTREME[c(FIND_EXTREME_OBSERVARION(df$densita,2))] <- 2
#plotto i dati evidenziando gli outliers
plot(df$densita, df$radice_vitamas, pch = 19, col = df$ESTREME, xlab="REGR", ylab="VAR_DIP")
summary(df[VAR_NUMERIC])
d_noout <- df[-c(FIND_EXTREME_OBSERVARION(df$densita,2),FIND_EXTREME_OBSERVARION(df$pil,2)),]
d_noout <-  d_noout[-c(27, 5),]
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod8 <- lm(log(resid(mod7)^2) ~  densita + urbana  + pil + dummy_ort + dummy_prot, d_noout)
sd_error <- sqrt(exp(fitted(mod8)))
mod9 <- lm(I(vitamas/sd_error) ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9)
anova(mod9)
white.test(mod9, d_noout)
par(mfrow=c(1,1))
plot(mod9, which = 1, pch = 19)
dwtest(mod9)
ols_coll_diag(mod9)
shapiro.test(resid(mod9))
# PROVO CON RADICE
d_noout$radice_vitamas = I(sqrt(d_noout$vitamas/sd_error))
shapiro.test(d_noout$radice_vitamas)
hist(df$inverso_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$inverso_vitamas),col=2, lwd=2)
mod9_new <- lm(d_noout$radice_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
# PROVO CON log
d_noout$log_vitamas = I(log(d_noout$vitamas/sd_error))
shapiro.test(d_noout$log_vitamas)
mod9_new <- lm(d_noout$log_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
# PROVO CON QUADRATO
d_noout$quad_vitamas = I((d_noout$vitamas/sd_error)^2)
shapiro.test(d_noout$log_vitamas)
mod9_new <- lm(d_noout$quad_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
ols_coll_diag(mod9_new)
shapiro.test(resid(mod9_new))
ks.test(resid(mod9_new),"pnorm")
# ETERO??
plot(mod9_new,which=1,pch=19)
# NORMALITA
hist(resid(mod9_new),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod9_new)),col=2,lwd=2)
plot(mod9_new,which=2,pch=19)
plot(mod9_new,which=3,pch=19)
plot(mod9_new,which=4,pch=19)
abline(h=2*4/nrow(d_noout),col=2,lwd=3,lty=2)
plot(mod9_new,which=5,pch=19)
d_noout[5,]
d_noout[28,]
d_noout[26,]
d_noout[24,]
d_noout[25,]
d_noout <-  d_noout[-c(25),]
d_noout[25,]
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod7 <- lm(vitamas ~ densita + urbana + pil + dummy_ort + dummy_prot, d_noout)
mod8 <- lm(log(resid(mod7)^2) ~  densita + urbana  + pil + dummy_ort + dummy_prot, d_noout)
sd_error <- sqrt(exp(fitted(mod8)))
mod9 <- lm(I(vitamas/sd_error) ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9)
anova(mod9)
white.test(mod9, d_noout)
par(mfrow=c(1,1))
plot(mod9, which = 1, pch = 19)
dwtest(mod9)
ols_coll_diag(mod9)
shapiro.test(resid(mod9))
# PROVO CON RADICE
d_noout$radice_vitamas = I(sqrt(d_noout$vitamas/sd_error))
shapiro.test(d_noout$radice_vitamas)
hist(df$inverso_vitamas, pch=19, cex=.5, col='lightgreen', freq = F, main = "Normalita'")
lines(density(df$inverso_vitamas),col=2, lwd=2)
mod9_new <- lm(d_noout$radice_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
# PROVO CON log
d_noout$log_vitamas = I(log(d_noout$vitamas/sd_error))
shapiro.test(d_noout$log_vitamas)
mod9_new <- lm(d_noout$log_vitamas ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), d_noout)
summary(mod9_new)
anova(mod9_new)
white.test(mod9_new, d_noout)
par(mfrow=c(1,1))
plot(mod9_new, which = 1, pch = 19)
dwtest(mod9_new)
shapiro.test(resid(mod9_new))
# ETERO??
plot(mod9_new,which=1,pch=19)
# NORMALITA
hist(resid(mod9_new),col="lightblue",freq=F,xlab="Resid",main="")
lines(density(resid(mod9_new)),col=2,lwd=2)
plot(mod9_new,which=2,pch=19)
plot(mod9_new,which=3,pch=19)
plot(mod9_new,which=4,pch=19)
abline(h=2*4/nrow(d_noout),col=2,lwd=3,lty=2)
summary(d_noout[VAR_NUMERIC])
summary(df[VAR_NUMERIC])
d_noout[27,]
d_noout[25,]
d_noout[5,]
d_noout <-  d_noout[-c(27, 5),]
d_noout <-  d_noout[-c(25),]
plot(mod9_new,which=5,pch=19)
library(car)
library(sjstats)
library(plotrix)
library(sjPlot)
library(sjmisc)
library(lme4)
library(pander)
library(car)
library(olsrr)
library(systemfit)
library(het.test)
library(ppcor)
library(car)
library(sjstats)
library(plotrix)
library(sjPlot)
library(sjmisc)
library(lme4)
library(pander)
library(car)
library(olsrr)
library(systemfit)
library(het.test)
library(ppcor)
library(car)
library(sjstats)
library(plotrix)
library(sjPlot)
library(sjmisc)
library(lme4)
library(pander)
library(car)
library(olsrr)
library(systemfit)
library(het.test)
library(ppcor)
white.test <- function(lmod,data){
u2 <- lmod$residuals^2
y <- fitted(lmod)
Ru2 <- summary(lm(u2 ~ y + I(y^2)))$r.squared
LM <- nrow(data)*Ru2
p.value <- 1-pchisq(LM, 2)
data.frame("Test statistic"=LM,"P value"=p.value)
}
#-- funzione per ottenere osservazioni outlier univariate
FIND_EXTREME_OBSERVARION <- function(x,sd_factor=2){
which(x>mean(x)+sd_factor*sd(x) | x<mean(x)-sd_factor*sd(x))
}
data_path <-"/Volumes/HDD_Ale/Statistical Modelling/Esercitazioni/3a_Esercitazione - Modelli Multivariati/R 01 - Modelli Multivariati/Esercizio 3/nazioni.csv"
df <- read.table(data_path, sep=";", header = T)
head(df)
df$relig <- factor(df$relig,1:3,c("catt","ortod","prot"))
str(df)
df$dummy_cat <- ifelse(df$relig==1,1,0)
df$dummy_ort <- ifelse(df$relig==2,1,0)
df$dummy_prot <- ifelse(df$relig==3,1,0)
VAR_NUMERIC <- c("densita","urbana","alfabet","pil", "vitamas", "vitafem")
summary(df[,VAR_NUMERIC]) #-- statistiche descrittive
cor(df[,VAR_NUMERIC]) #-- matrice di correlazione
plot(df[,VAR_NUMERIC],pch=19,cex=.5) #-- scatter plot multivariato
par(mfrow=c(2,3))
for(i in VAR_NUMERIC){
boxplot(df[,i],main=i,col="lightblue",ylab=i)
}
par(mfrow=c(2,3))
for(i in VAR_NUMERIC){
hist(df[,i],main=i,col="lightblue",xlab=i,freq=F)
}
mod1 <- lm(vitamas ~ densita + urbana + alfabet + pil + dummy_ort + dummy_prot, df)
summary(mod1)
anova(mod1)
white.test(mod1, df)
par(mfrow=c(1,1))
dwtest(mod1)
dwtest(mod1)
summary(mod1)
mod2 <- lm(log(resid(mod1)^2) ~  densita + urbana + alfabet + pil + dummy_ort + dummy_prot, df)
sd_error <- sqrt(exp(fitted(mod2)))
mod3 <- lm(I(vitamas/sd_error) ~ 0 + I(1/sd_error) + I(densita/sd_error) + I(urbana/sd_error) + I(alfabet/sd_error)+ I(pil/sd_error)+ I(dummy_ort/sd_error)+ I(dummy_prot/sd_error), df)
summary(mod3)
anova(mod3)
summary(mod3)
anova(mod3)
white.test(mod3, df)
par(mfrow=c(1,1))
plot(mod3, which = 1, pch = 19)
dwtest(mod3)
library(car)
library(sjstats)
library(plotrix)
library(sjPlot)
library(sjmisc)
library(lme4)
library(pander)
library(car)
library(olsrr)
library(systemfit)
library(het.test)
library(ppcor)
dwtest(mod1)
